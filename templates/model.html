<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model & Evaluation</title>

    <!-- Static CSS -->
    <link rel="stylesheet" href="/static/base.css?v=0.4">
</head>

<body>

    <div class="page-container glass">

        <a href="/">‚Üê Back to Home</a>

        <h1>Model & Evaluation</h1>

        <p>
            This section describes the modeling approach used to estimate tail
            risk in insurance claim severity and the metrics employed to evaluate
            performance. The emphasis is on understanding the learning objective
            and evaluation criteria relevant to tail-focused prediction, rather
            than on average error minimization.
        </p>

        <h2>Model Choice: CatBoost Quantile Regression</h2>

        <img
            src="/assets/catboost.png"
            alt="CatBoost Logo"
            style="
                width: 220px;
                margin: 20px 0 28px 0;
                display: block;
            "
        >

        <p>
            The Allstate Claims Severity dataset consists of a high-dimensional
            mix of continuous and categorical features with anonymized semantics.
            This structure makes linear models and naive one-hot encoding
            approaches impractical due to feature explosion and limited ability
            to capture non-linear interactions.
        </p>

        <p>
            CatBoost was selected due to its native support for categorical
            variables through ordered target statistics, which reduces target
            leakage while avoiding sparse representations. As a tree-based
            ensemble method, it is well-suited for modeling complex interactions
            and skewed loss distributions commonly observed in insurance data.
        </p>

        <h2>Quantile Objective (œÑ = 0.90)</h2>

        <p>
            Instead of predicting the conditional mean of claim severity, the
            model is trained to estimate the conditional 90th percentile
            (œÑ = 0.90). For a given claim profile, the prediction represents a
            threshold that 90% of comparable claims are expected not to exceed.
        </p>

        <p>
            This formulation aligns naturally with risk-sensitive decision
            making, where underestimating high-severity claims is substantially
            more costly than conservative overestimation.
        </p>

        <h2>Evaluation Metrics</h2>

        <h2>Pinball Loss (aka. Quantile Loss)</h2>

        <p>
            Pinball loss is the canonical loss function used in quantile
            regression. It applies asymmetric penalties depending on whether the
            predicted quantile lies above or below the observed value, with the
            degree of asymmetry controlled by the quantile level œÑ.
        </p>

        <p>
            For upper quantiles such as œÑ = 0.90, underprediction incurs a
            heavier penalty than overprediction. This makes pinball loss
            particularly suitable for tail-risk modeling, where missing extreme
            outcomes is more harmful than predicting conservatively.
        </p>

        <p>
            Pinball loss is scale-dependent and does not have a fixed upper
            bound. As a result, it is most informative when comparing competing
            models trained on the same dataset and quantile objective.
        </p>

        <img
            src="/assets/quantile_loss.jpeg"
            alt="Pinball Loss Visualization"
            style="
                width: 100%;
                max-width: 400px;
                margin: 16px 0 24px 0;
                display: block;
            "
        >

        <h2>D¬≤ Pinball Score (Quantile R¬≤ Score)</h2>

        <p>
            D¬≤ is a quantile-specific analogue of the traditional R¬≤ metric used
            in mean regression. It measures the relative improvement of a
            quantile regression model over a naive baseline that predicts an
            unconditional quantile.
        </p>

        <p>
            Unlike classical R¬≤, D¬≤ evaluates how well the model explains
            variation in the conditional quantile rather than the conditional
            mean. This makes it a more appropriate measure of explanatory power
            for quantile-based objectives.
        </p>

        <p>
            D¬≤ values typically range from negative values to 1. Higher values
            indicate stronger explanatory power relative to the baseline, while
            values near zero suggest limited improvement.
        </p>

        <img
            src="/assets/d2_pinball_score.jpeg"
            alt="D¬≤ Score Visualization"
            style="
                width: 100%;
                max-width: 400px;
                margin: 16px 0 24px 0;
                display: block;
            "
        >

        <h2>Coverage</h2>

        <p>
            Coverage evaluates the calibration of a quantile regression model by
            measuring the proportion of observed outcomes that fall below the
            predicted quantile. For a well-calibrated model, empirical coverage
            should closely match the nominal quantile level.
        </p>

        <p>
            Coverage is particularly important in tail-risk applications, as
            systematic under- or over-coverage directly translates into
            misestimation of risk thresholds used for reserving and pricing.
        </p>

        <p>
            Coverage values lie between 0 and 1. Deviations from the target
            quantile indicate miscalibration, even if other accuracy metrics
            appear favorable.
        </p>

        <img
            src="/assets/coverage.jpeg"
            alt="Coverage Calibration Visualization"
            style="
                width: 100%;
                max-width: 500px;
                margin: 16px 0 24px 0;
                display: block;
            "
        >

        <h2>Model Performance Interpretation</h2>

        <p>
            When evaluated under the 0.90 quantile objective, the trained
            CatBoost model demonstrates stable tail-focused performance across
            all three evaluation criteria.
        </p>

        <p>
            The D¬≤ value of 0.4859 implies that the model explains approximately
            48% of the variation in the conditional 90th percentile relative to a
            naive quantile baseline.
        </p>

        <p>
            The empirical coverage of 0.8940 is very close to the nominal target
            of 0.90, indicating good calibration. The model achieves a mean pinball loss of 341.46, 
            indicating stable performance under the 0.90 quantile objective.
        </p>

        <!-- ROW 1 -->
        <div
            style="
                display: flex;
                gap: 28px;
                margin-top: 22px;
                flex-wrap: wrap;
            "
        >
            <div
                style="
                    flex: 1;
                    min-width: 300px;
                    background: rgba(255,255,255,0.06);
                    border: 1px solid rgba(255,255,255,0.18);
                    border-radius: 16px;
                    padding: 18px;
                "
            >
                <h3 style="margin-bottom: 12px; color: #c7d2fe;">
                    Quantile Prediction Behavior
                </h3>

                <img
                    src="/assets/newplot.png"
                    alt="Model Output Visualization"
                    style="width: 100%; border-radius: 12px;"
                >
            </div>

            <div
                style="
                    flex: 1;
                    min-width: 300px;
                    background: rgba(255,255,255,0.06);
                    border: 1px solid rgba(255,255,255,0.18);
                    border-radius: 16px;
                    padding: 18px;
                "
            >
                <h3 style="margin-bottom: 12px; color: #c7d2fe;">
                    Top Feature Importances
                </h3>

                <img
                    src="/assets/feature_imp.png"
                    alt="Feature Importance Visualization"
                    style="width: 100%; border-radius: 12px;"
                >
            </div>
        </div>

        <!-- ROW 2 -->
        <div
            style="
                margin-top: 28px;
                background: rgba(255,255,255,0.06);
                border: 1px solid rgba(255,255,255,0.18);
                border-radius: 16px;
                padding: 18px;
            "
        >
            <h3 style="margin-bottom: 12px; color: #c7d2fe;">
                Model Evaluation Metrics
            </h3>

            <img
                src="/assets/metrics.png"
                alt="Model Metrics Visualization"
                style="
                    width: 100%;
                    max-width: 520px;
                    margin: auto;
                    border-radius: 12px;
                    display: block;
                "
            >
        </div>

    </div>

    <div class="footer">
        Author: Aryan Kaisth üôÇ
    </div>

</body>
</html>
